// const products = [
//   {
//     id: 1,
//     name: "Gradient Graphic T-shirt",
//     originalPrice: "",
//     currentPrice: "$145",
//     image: "assets/images/hoddie-3-grey.png",
//     category: "T-Shirts",
//     size: ["XS", "S", "M", "L", "XL", "XXL"],
//     description: "Comfortable graphic t-shirt with gradient design.",
//     inStock: true,
//     rating: "★★★★★",
//     reviewCount: "4.9",
//   },
//   {
//     id: 2,
//     name: "Polo with Tipping Details",
//     originalPrice: "",
//     currentPrice: "$180",
//     image: "assets/images/hoddie-3-grey.png",
//     category: "Shirts",
//     size: ["XS", "S", "M", "L", "XL", "XXL"],
//     description: "Classic polo shirt with tipping details.",
//     inStock: true,
//     rating: "★★★★☆",
//     reviewCount: "4.5",
//   },
//   {
//     id: 3,
//     name: "Black Striped T-shirt",
//     originalPrice: "$160",
//     currentPrice: "$120",
//     image: "assets/images/hoddie-3-grey.png",
//     category: "T-Shirts",
//     size: ["XS", "S", "M", "L", "XL", "XXL"],
//     description: "Stylish black t-shirt with striped pattern.",
//     inStock: true,
//     rating: "★★★★☆",
//     reviewCount: "4.3",
//     discount: "-30%",
//   },
//   {
//     id: 4,
//     name: "Skinny Fit Jeans",
//     originalPrice: "$260",
//     currentPrice: "$240",
//     image: "assets/images/hoddie-3-grey.png",
//     category: "Jeans",
//     size: ["XS", "S", "M", "L", "XL", "XXL"],
//     description: "Modern skinny fit jeans with premium denim.",
//     inStock: true,
//     rating: "★★★★★",
//     reviewCount: "4.8",
//     discount: "-20%",
//   },
//   {
//     id: 5,
//     name: "Checkered Shirt",
//     originalPrice: "$160",
//     currentPrice: "$180",
//     image: "assets/images/hoddie-3-grey.png",
//     category: "Shirts",
//     size: ["XS", "S", "M", "L", "XL", "XXL"],
//     description: "Classic checkered shirt for casual wear.",
//     inStock: true,
//     rating: "★★★★☆",
//     reviewCount: "4.5",
//   },
//   {
//     id: 6,
//     name: "Sleeve Striped T-shirt",
//     originalPrice: "$160",
//     currentPrice: "$130",
//     image: "assets/images/hoddie-3-grey.png",
//     category: "T-Shirts",
//     size: ["XS", "S", "M", "L", "XL", "XXL"],
//     description: "Trendy t-shirt with sleeve stripe design.",
//     inStock: true,
//     rating: "★★★★☆",
//     reviewCount: "4.5",
//     discount: "-20%",
//   },
//   {
//     id: 7,
//     name: "Vertical Striped Shirt",
//     originalPrice: "$232",
//     currentPrice: "$212",
//     image: "assets/images/hoddie-3-grey.png",
//     category: "Shirts",
//     size: ["XS", "S", "M", "L", "XL", "XXL"],
//     description: "Elegant vertical striped shirt for formal occasions.",
//     inStock: true,
//     rating: "★★★★★",
//     reviewCount: "5.0",
//     discount: "-25%",
//   },
//   {
//     id: 8,
//     name: "Courage Graphic T-shirt",
//     originalPrice: "",
//     currentPrice: "$145",
//     image: "assets/images/hoddie-3-grey.png",
//     category: "T-Shirts",
//     size: ["XS", "S", "M", "L", "XL", "XXL"],
//     description: "Inspiring graphic t-shirt with courage theme.",
//     inStock: true,
//     rating: "★★★★☆",
//     reviewCount: "4.6",
//   },
// ];

const products = [
  {
    id: 1,
    name: "Black Hoodie",
    originalPrice: "",
    currentPrice: "$599",
    image: "./assets/images/black-hoodie.png",
    category: "Hoodies",
    size: ["S", "M", "L", "XL"],
    description: "Comfy cotton hoodie with a modern fit.",
    inStock: true,
    rating: "★★★★☆",
    reviewCount: "4.5",
    // discount: "-15%",
  },
  {
    id: 2,
    name: "White T-Shirt",
    originalPrice: "$349",
    currentPrice: "$299",
    image: "./assets/images/white-t-shirt.png",
    category: "T-Shirts",
    size: ["M", "L"],
    description: "Minimalist white tee for everyday wear.",
    inStock: true,
    rating: "★★★★☆",
    reviewCount: "4.0",
    discount: "-15%",
  },
  {
    id: 3,
    name: "Blue Hoodie",
    originalPrice: "$699",
    currentPrice: "$599",
    image: "./assets/images/hoddie-2-blue.png",
    category: "Hoodies",
    size: ["S", "M", "L", "XL"],
    description: "Classic blue hoodie for a relaxed look.",
    inStock: true,
    rating: "★★★★☆",
    reviewCount: "4.3",
    discount: "-15%",
  },
  {
    id: 4,
    name: "Black Jacket",
    originalPrice: "$899",
    currentPrice: "$799",
    image: "./assets/images/BlackJacket-Photoroom.png",
    category: "Jackets",
    size: ["S", "M", "L"],
    description: "Sleek black jacket for a polished appearance.",
    inStock: true,
    rating: "★★★★☆",
    reviewCount: "4.7",
    discount: "-12%",
  },
  {
    id: 5,
    name: "BlackMother Hoodie",
    originalPrice: "",
    currentPrice: "$649",
    image: "./assets/images/BlackMother-Photoroom.png",
    category: "Hoodies",
    size: ["M", "L", "XL"],
    description: "Trendy hoodie with unique graphics.",
    inStock: true,
    rating: "★★★★☆",
    reviewCount: "4.6",
    // discount: "-14%",
  },
  {
    id: 6,
    name: "Black T-Shirt",
    originalPrice: "",
    currentPrice: "$299",
    image: "./assets/images/BlackTshirtPart-Photoroom.png",
    category: "T-Shirts",
    size: ["S", "M", "L"],
    description: "Essential black tee for versatile styling.",
    inStock: true,
    rating: "★★★★☆",
    reviewCount: "4.2",
    // discount: "-15%",
  },
  {
    id: 7,
    name: "Blue Jacket",
    originalPrice: "",
    currentPrice: "$799",
    image: "./assets/images/BlueJacket-Photoroom.png",
    category: "Jackets",
    size: ["S", "M", "L"],
    description: "Stylish blue jacket for any occasion.",
    inStock: true,
    rating: "★★★★☆",
    reviewCount: "4.5",
    // discount: "-12%",
  },
  {
    id: 8,
    name: "Blue T-Shirt",
    originalPrice: "$349",
    currentPrice: "$299",
    image: "./assets/images/BlueTshirt-Photoroom.png",
    category: "T-Shirts",
    size: ["S", "M", "L"],
    description: "Vibrant blue tee for a fresh look.",
    inStock: true,
    rating: "★★★★☆",
    reviewCount: "4.1",
    discount: "-15%",
  },
  {
    id: 9,
    name: "Brown Sweatpants",
    originalPrice: "",
    currentPrice: "$399",
    image: "./assets/images/BrownSweatpants-Photoroom.png",
    category: "Pants",
    size: ["S", "M", "L", "XL"],
    description: "Comfortable sweatpants for lounging.",
    inStock: true,
    rating: "★★★★☆",
    reviewCount: "4.4",
    // discount: "-20%",
  },
  {
    id: 10,
    name: "Black Hoodie",
    originalPrice: "$649",
    currentPrice: "$549",
    image: "./assets/images//black-hoodie.png",
    category: "Sweatshirts",
    size: ["M", "L", "XL"],
    description: "Cozy sweatshirt with a sporty vibe.",
    inStock: true,
    rating: "★★★★☆",
    reviewCount: "4.3",
    discount: "-16%",
  },
  {
    id: 11,
    name: "Dark Blue T-Shirt",
    originalPrice: "$349",
    currentPrice: "$299",
    image: "./assets/images/DarkBlueTshirt-Photoroom.png",
    category: "T-Shirts",
    size: ["S", "M", "L"],
    description: "Rich dark blue tee for a refined look.",
    inStock: true,
    rating: "★★★★☆",
    reviewCount: "4.0",
    discount: "-15%",
  },
  {
    id: 12,
    name: "Flower Sweatshirt",
    originalPrice: "",
    currentPrice: "$499",
    image: "./assets/images/FlowerSweatshirt-Photoroom.png",
    category: "Sweatshirts",
    size: ["S", "M", "L"],
    description: "Playful floral design for a fun outfit.",
    inStock: true,
    rating: "★★★★☆",
    reviewCount: "4.5",
    // discount: "-17%",
  },
  {
    id: 13,
    name: "Grey Sweatpants",
    originalPrice: "$499",
    currentPrice: "$399",
    image: "./assets/images/GreySweatPants-Photoroom.png",
    category: "Pants",
    size: ["S", "M", "L", "XL"],
    description: "Soft grey sweatpants for ultimate comfort.",
    inStock: true,
    rating: "★★★★☆",
    reviewCount: "4.6",
    discount: "-20%",
  },
  {
    id: 14,
    name: "HeadOfTheTable Hoodie",
    originalPrice: "",
    currentPrice: "$649",
    image: "./assets/images/HeadOfTheTableHoodie-Photoroom.png",
    category: "Hoodies",
    size: ["M", "L", "XL"],
    description: "Bold statement hoodie for confident wearers.",
    inStock: true,
    rating: "★★★★☆",
    reviewCount: "4.7",
    // discount: "-14%",
  },
  {
    id: 15,
    name: "Silver Jacket",
    originalPrice: "$899",
    currentPrice: "$799",
    image: "./assets/images/SilverJacket-Photoroom.png",
    category: "Jackets",
    size: ["S", "M", "L"],
    description: "Rugged denim jacket for a timeless look.",
    inStock: true,
    rating: "★★★★☆",
    reviewCount: "4.4",
    discount: "-12%",
  },
  {
    id: 16,
    name: "PeriodicTable Blue Hoodie",
    originalPrice: "$699",
    currentPrice: "$599",
    image: "./assets/images/PeriodicTableBlueHoodie-Photoroom.png",
    category: "Hoodies",
    size: ["S", "M", "L", "XL"],
    description: "Science-inspired hoodie for nerdy charm.",
    inStock: true,
    rating: "★★★★☆",
    reviewCount: "4.8",
    discount: "-15%",
  },
  {
    id: 17,
    name: "Pink Sweatpants",
    originalPrice: "",
    currentPrice: "$399",
    image: "./assets/images/PinkSweatpants-Photoroom.png",
    category: "Pants",
    size: ["S", "M", "L"],
    description: "Fun pink sweatpants for a pop of color.",
    inStock: true,
    rating: "★★★★☆",
    reviewCount: "4.2",
    // discount: "-20%",
  },
  {
    id: 18,
    name: "Red T-Shirt",
    originalPrice: "$349",
    currentPrice: "$299",
    image: "./assets/images/RedTshirt-Photoroom.png",
    category: "T-Shirts",
    size: ["S", "M", "L"],
    description: "Vibrant red tee to stand out.",
    inStock: true,
    rating: "★★★★☆",
    reviewCount: "4.3",
    discount: "-15%",
  },
  {
    id: 19,
    name: "Sandy Sweatpants",
    originalPrice: "$499",
    currentPrice: "$399",
    image: "./assets/images/SandySweatpants-Photoroom.png",
    category: "Pants",
    size: ["S", "M", "L"],
    description: "Neutral-toned sweatpants for easy pairing.",
    inStock: true,
    rating: "★★★★☆",
    reviewCount: "4.1",
    discount: "-20%",
  },
  {
    id: 20,
    name: "Silver Jacket",
    originalPrice: "",
    currentPrice: "$899",
    image: "./assets/images/SilverJacket-Photoroom.png",
    category: "Jackets",
    size: ["S", "M", "L"],
    description: "Metallic jacket for a futuristic edge.",
    inStock: true,
    rating: "★★★★★",
    reviewCount: "4.9",
    // discount: "-10%",
  },
  {
    id: 21,
    name: "Turquoise T-Shirt",
    originalPrice: "$349",
    currentPrice: "$299",
    image: "./assets/images/TerquazTshirt-Photoroom.png",
    category: "T-Shirts",
    size: ["S", "M", "L"],
    description: "Eye-catching turquoise tee for summer.",
    inStock: true,
    rating: "★★★★☆",
    reviewCount: "4.0",
    discount: "-15%",
  },
  {
    id: 22,
    name: "White Hoodie",
    originalPrice: "$349",
    currentPrice: "$299",
    image: "./assets/images/hoddie-1-white.png",
    category: "T-Shirts",
    size: ["S", "M", "L"],
    description: "Crisp white tee for a clean aesthetic.",
    inStock: true,
    rating: "★★★★☆",
    reviewCount: "4.5",
    discount: "-15%",
  },
];

// Pagination configuration
const itemsPerPage = 6; // Number of items to show per page
let currentPage = 1;

// Price Range Slider functionality
document.addEventListener("DOMContentLoaded", function () {
  const sliderTrack = document.querySelector(".slider-track");
  const sliderRange = document.querySelector(".slider-range");
  const thumbMin = document.getElementById("thumbMin");
  const thumbMax = document.getElementById("thumbMax");
  const minValue = document.getElementById("minValue");
  const maxValue = document.getElementById("maxValue");

  const minPrice = 50;
  const maxPrice = 1000;
  let isDragging = null;

  // Initialize slider positions
  updateSlider(0, 100); // Start with full range

  function updateSlider(minPercent, maxPercent) {
    if (!sliderRange || !thumbMin || !thumbMax || !minValue || !maxValue)
      return;

    // Update the range track
    sliderRange.style.left = minPercent + "%";
    sliderRange.style.width = maxPercent - minPercent + "%";

    // Update thumb positions
    thumbMin.style.left = minPercent + "%";
    thumbMax.style.left = maxPercent + "%";

    // Calculate and update price values
    const minPriceValue = Math.round(
      minPrice + (minPercent / 100) * (maxPrice - minPrice)
    );
    const maxPriceValue = Math.round(
      minPrice + (maxPercent / 100) * (maxPrice - minPrice)
    );

    minValue.textContent = "$" + minPriceValue;
    maxValue.textContent = "$" + maxPriceValue;
  }

  function handleMouseDown(e) {
    const thumb = e.target;
    if (thumb.id === "thumbMin" || thumb.id === "thumbMax") {
      isDragging = thumb.id;
      document.addEventListener("mousemove", handleMouseMove);
      document.addEventListener("mouseup", handleMouseUp);
    }
  }

  function handleMouseMove(e) {
    if (!isDragging || !sliderTrack) return;

    const trackRect = sliderTrack.getBoundingClientRect();
    const percent = Math.min(
      Math.max(((e.clientX - trackRect.left) / trackRect.width) * 100, 0),
      100
    );

    const currentMinPercent = parseFloat(thumbMin.style.left);
    const currentMaxPercent = parseFloat(thumbMax.style.left);

    if (isDragging === "thumbMin") {
      const newMinPercent = Math.min(percent, currentMaxPercent - 1);
      updateSlider(newMinPercent, currentMaxPercent);
    } else {
      const newMaxPercent = Math.max(percent, currentMinPercent + 1);
      updateSlider(currentMinPercent, newMaxPercent);
    }
  }

  function handleMouseUp() {
    isDragging = null;
    document.removeEventListener("mousemove", handleMouseMove);
    document.removeEventListener("mouseup", handleMouseUp);
  }

  // Add event listeners
  thumbMin.addEventListener("mousedown", handleMouseDown);
  thumbMax.addEventListener("mousedown", handleMouseDown);
});

// Function to generate product card HTML
function generateProductCard(product) {
  return `
    <div class="product-card" data-product-id="${product.id}">
      <div class="product-image">
        <img src="${product.image}" alt="${product.name}" />
      </div>
      <div class="product-info">
        <h3 class="product-name">${product.name}</h3>
        <div class="product-rating">
          <div class="stars">${product.rating}</div>
          <div class="review-count">${product.reviewCount}</div>
        </div>
        <div class="product-price">
          <span class="current-price">${product.currentPrice}</span>
          ${
            product.originalPrice
              ? `<span class="original-price">${product.originalPrice}</span>`
              : ""
          }
          ${
            product.discount
              ? `<span class="discount-badge">${product.discount}</span>`
              : ""
          }
        </div>
      </div>
    </div>
  `;
}

// Function to generate pagination HTML
function generatePagination(totalPages) {
  let paginationHTML = '<div class="pagination">';

  // Previous button
  paginationHTML += `
    <div class="page-nav" ${
      currentPage === 1 ? 'style="opacity: 0.5; pointer-events: none;"' : ""
    }>
      ← Previous
    </div>
  `;

  // Page numbers
  paginationHTML += '<div class="page-numbers">';

  // Always show first page
  paginationHTML += `
    <div class="page-number ${
      currentPage === 1 ? "active" : ""
    }" data-page="1">1</div>
  `;

  // Show ellipsis if needed
  if (currentPage > 3) {
    paginationHTML += "<span>...</span>";
  }

  // Show pages around current page
  for (
    let i = Math.max(2, currentPage - 1);
    i <= Math.min(totalPages - 1, currentPage + 1);
    i++
  ) {
    paginationHTML += `
      <div class="page-number ${
        currentPage === i ? "active" : ""
      }" data-page="${i}">${i}</div>
    `;
  }

  // Show ellipsis if needed
  if (currentPage < totalPages - 2) {
    paginationHTML += "<span>...</span>";
  }

  // Always show last page if there's more than one page
  if (totalPages > 1) {
    paginationHTML += `
      <div class="page-number ${
        currentPage === totalPages ? "active" : ""
      }" data-page="${totalPages}">${totalPages}</div>
    `;
  }

  paginationHTML += "</div>";

  // Next button
  paginationHTML += `
    <div class="page-nav" ${
      currentPage === totalPages
        ? 'style="opacity: 0.5; pointer-events: none;"'
        : ""
    }>
      Next →
    </div>
  `;

  paginationHTML += "</div>";
  return paginationHTML;
}

// Function to show product modal
function showProductModal(product) {
  const modal = document.getElementById("productModal");
  const modalImage = document.getElementById("modalProductImage");
  const modalName = document.getElementById("modalProductName");
  const modalRating = document.getElementById("modalProductRating");
  const modalReviewCount = document.getElementById("modalReviewCount");
  const modalCurrentPrice = document.getElementById("modalCurrentPrice");
  const modalOriginalPrice = document.getElementById("modalOriginalPrice");
  const modalDiscountBadge = document.getElementById("modalDiscountBadge");

  // Update modal content
  modalImage.src = product.image;
  modalImage.alt = product.name;
  modalName.textContent = product.name;
  modalRating.innerHTML = product.rating;
  modalReviewCount.textContent = `(${product.reviewCount})`;
  modalCurrentPrice.textContent = product.currentPrice;

  // Handle original price and discount display
  if (product.originalPrice) {
    modalOriginalPrice.textContent = product.originalPrice;
    modalOriginalPrice.style.display = "inline";
  } else {
    modalOriginalPrice.style.display = "none";
  }

  if (product.discount) {
    modalDiscountBadge.textContent = product.discount;
    modalDiscountBadge.style.display = "inline";
  } else {
    modalDiscountBadge.style.display = "none";
  }

  // Set up size options
  const sizeOptions = document.querySelectorAll(".size-option");
  sizeOptions.forEach((option) => {
    const size = option.textContent;
    if (product.size.includes(size)) {
      option.style.display = "block";
      option.classList.remove("active");
      if (size === "M") {
        // Default to Medium or first size
        option.classList.add("active");
      }
    } else {
      option.style.display = "none";
    }
  });

  // Reset quantity to 1
  const quantityValue = document.querySelector(".quantity-value");
  if (quantityValue) {
    quantityValue.textContent = "1";
  }

  // Set up quantity selection
  const minusBtn = document.querySelector(".quantity-btn.minus");
  const plusBtn = document.querySelector(".quantity-btn.plus");

  if (minusBtn) {
    minusBtn.onclick = function () {
      const quantityValue = document.querySelector(".quantity-value");
      let quantity = parseInt(quantityValue.textContent);
      if (quantity > 1) {
        quantityValue.textContent = quantity - 1;
      }
    };
  }

  if (plusBtn) {
    plusBtn.onclick = function () {
      const quantityValue = document.querySelector(".quantity-value");
      let quantity = parseInt(quantityValue.textContent);
      quantityValue.textContent = quantity + 1;
    };
  }

  // Set up add to cart button
  const addToCartBtn = document.querySelector(".add-to-cart-btn");
  if (addToCartBtn) {
    // Remove any existing event listeners
    const newAddToCartBtn = addToCartBtn.cloneNode(true);
    addToCartBtn.parentNode.replaceChild(newAddToCartBtn, addToCartBtn);

    // Add new event listener
    newAddToCartBtn.addEventListener("click", function () {
      // Get selected size
      const activeSize = document.querySelector(".size-option.active");
      if (!activeSize) {
        alert("Please select a size");
        return;
      }
      const selectedSize = activeSize.textContent;

      // Get quantity
      const quantity = parseInt(
        document.querySelector(".quantity-value").textContent
      );

      // Get current cart from localStorage
      const userId = localStorage.getItem("userId") || "guest";
      const cartKey = `cart_${userId}`;
      let cart = JSON.parse(localStorage.getItem(cartKey)) || [];

      // Add item to cart
      cart.push({
        id: product.id,
        name: product.name,
        price: product.currentPrice,
        image: product.image,
        size: selectedSize,
        quantity: quantity,
      });

      // Save cart back to localStorage
      localStorage.setItem(cartKey, JSON.stringify(cart));

      // Update cart count if the function exists
      if (typeof updateCartCount === "function") {
        updateCartCount();
      }

      // Show success message
      alert("Item added to cart successfully!");

      // Close modal
      closeProductModal();
    });
  }

  // Set up size selection
  const sizeOptionButtons = document.querySelectorAll(".size-option");
  sizeOptionButtons.forEach((button) => {
    button.addEventListener("click", function () {
      // Remove active class from all buttons
      sizeOptionButtons.forEach((btn) => btn.classList.remove("active"));
      // Add active class to clicked button
      this.classList.add("active");
    });
  });

  // Set up color selection
  const colorOptions = document.querySelectorAll(".color-option");
  colorOptions.forEach((option) => {
    option.addEventListener("click", function () {
      // Remove active class from all options
      colorOptions.forEach((opt) => opt.classList.remove("active"));
      // Add active class to clicked option
      this.classList.add("active");
    });
  });

  // Show modal
  modal.style.display = "block";
  document.body.style.overflow = "hidden"; // Prevent scrolling when modal is open
}

// Function to close product modal
function closeProductModal() {
  const modal = document.getElementById("productModal");
  if (modal) {
    modal.style.display = "none";
    document.body.style.overflow = ""; // Restore scrolling
  }
}

// Initialize the modal
document.addEventListener("DOMContentLoaded", function () {
  // Setup close button in modal
  const closeModalBtn = document.querySelector(".close-modal");
  if (closeModalBtn) {
    closeModalBtn.addEventListener("click", closeProductModal);
  }

  // Close modal when clicking outside
  const modal = document.getElementById("productModal");
  if (modal) {
    modal.addEventListener("click", function (e) {
      if (e.target === modal) {
        closeProductModal();
      }
    });
  }

  // Close modal when pressing Escape key
  document.addEventListener("keydown", function (e) {
    if (e.key === "Escape" && modal.style.display === "block") {
      closeProductModal();
    }
  });

  // Make sure we only have one modal in the HTML
  const extraModal = document.querySelector(".modal");
  if (extraModal) {
    extraModal.remove(); // Remove the duplicate modal
  }
});

// Add this function if it's missing
function updateCartCount() {
  const userId = localStorage.getItem("userId") || "guest";
  const cartKey = `cart_${userId}`;
  const cart = JSON.parse(localStorage.getItem(cartKey)) || [];

  const cartCountElement = document.querySelector(".cart-count");
  if (cartCountElement) {
    if (cart.length > 0) {
      cartCountElement.textContent = cart.length;
      cartCountElement.style.display = "flex";
    } else {
      cartCountElement.style.display = "none";
    }
  }
}

// Function to render products for current page
function renderProducts() {
  const productsGrid = document.querySelector(".products-grid");
  const paginationContainer = document.querySelector(".pagination-container");

  if (!productsGrid) return;

  // Calculate pagination
  const totalPages = Math.ceil(products.length / itemsPerPage);
  const startIndex = (currentPage - 1) * itemsPerPage;
  const endIndex = startIndex + itemsPerPage;
  const currentProducts = products.slice(startIndex, endIndex);

  // Clear and render products
  productsGrid.innerHTML = currentProducts.map(generateProductCard).join("");

  // Add click event listeners to product cards
  const productCards = productsGrid.querySelectorAll(".product-card");
  productCards.forEach((card) => {
    card.addEventListener("click", () => {
      const productId = parseInt(card.dataset.productId);
      const product = products.find((p) => p.id === productId);
      if (product) {
        showProductModal(product);
      }
    });
  });

  // Render pagination
  if (paginationContainer) {
    paginationContainer.innerHTML = generatePagination(totalPages);

    // Add event listeners to pagination elements
    const pageNumbers = paginationContainer.querySelectorAll(".page-number");
    const prevButton = paginationContainer.querySelector(
      ".page-nav:first-child"
    );
    const nextButton = paginationContainer.querySelector(
      ".page-nav:last-child"
    );

    // Handle page number clicks
    pageNumbers.forEach((pageNumber) => {
      pageNumber.addEventListener("click", () => {
        const page = parseInt(pageNumber.dataset.page);
        if (page !== currentPage) {
          currentPage = page;
          renderProducts();
        }
      });
    });

    // Handle previous button click
    if (prevButton) {
      prevButton.addEventListener("click", () => {
        if (currentPage > 1) {
          currentPage--;
          renderProducts();
        }
      });
    }

    // Handle next button click
    if (nextButton) {
      nextButton.addEventListener("click", () => {
        if (currentPage < totalPages) {
          currentPage++;
          renderProducts();
        }
      });
    }
  }
}

// Initialize products display and modal event listeners
document.addEventListener("DOMContentLoaded", function () {
  // Initial render of products
  renderProducts();

  // Update product count
  updateProductCount(products);

  // Add modal event listeners
  const modal = document.getElementById("productModal");
  const closeModalBtn = document.querySelector(".close-modal");

  if (modal) {
    // Close modal when clicking outside
    modal.addEventListener("click", (e) => {
      if (e.target === modal) {
        closeProductModal();
      }
    });

    // Close modal when pressing Escape key
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape" && modal.style.display === "block") {
        closeProductModal();
      }
    });
  }

  if (closeModalBtn) {
    closeModalBtn.addEventListener("click", closeProductModal);
  }
});

// Function to update product count display
function updateProductCount(products) {
  const countElement = document.getElementById("productsCount");
  if (countElement) {
    countElement.textContent = `Showing 1-${products.length} of ${products.length} Products`;
  }
}

// Function to handle color filter selection
function handleColorFilter() {
  const colorFilters = document.querySelectorAll(".color-filter");
  let selectedColor = null;

  colorFilters.forEach((filter) => {
    filter.addEventListener("click", () => {
      // Toggle active class
      if (filter.classList.contains("active")) {
        filter.classList.remove("active");
        selectedColor = null;
      } else {
        colorFilters.forEach((f) => f.classList.remove("active"));
        filter.classList.add("active");
        selectedColor = filter.style.backgroundColor;
      }

      // Filter products based on selected color
      const filteredProducts = selectedColor
        ? products.filter((product) => product.color === selectedColor)
        : products;

      // Update pagination for filtered products
      currentPage = 1;
      totalPages = Math.ceil(filteredProducts.length / itemsPerPage);
      renderProducts(filteredProducts);
    });
  });
}

// Function to handle size filter selection
function handleSizeFilter() {
  const sizeFilters = document.querySelectorAll(".size-filter");
  let selectedSize = null;

  sizeFilters.forEach((filter) => {
    filter.addEventListener("click", () => {
      // Toggle active class
      if (filter.classList.contains("active")) {
        filter.classList.remove("active");
        selectedSize = null;
      } else {
        sizeFilters.forEach((f) => f.classList.remove("active"));
        filter.classList.add("active");
        selectedSize = filter.textContent;
      }
    });
  });
}

// Initialize filters when DOM is loaded
document.addEventListener("DOMContentLoaded", () => {
  handleColorFilter();
  handleSizeFilter();
  renderProducts(products);
});
